\documentclass[DM,lsstdraft,STR,toc]{lsstdoc}
\usepackage{geometry}
\usepackage{longtable,booktabs}
\usepackage{enumitem}
\usepackage{arydshln}

\input meta.tex

\providecommand{\tightlist}{
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\begin{document}

\def\milestoneName{Spectrograph Data Acquisition}
\def\milestoneId{LDM-503-8}
\def\product{Data Management}

\setDocCompact{true}

\title[\milestoneId{}~Test Report]{\milestoneId{} (\milestoneName{})~Test Plan and Report}
\setDocRef{\lsstDocType-\lsstDocNum}
\setDocDate{\vcsdate}
\setDocUpstreamLocation{\url{https://github.com/lsst/lsst-texmf/examples}}
\author{ Michelle Butler }

\input history_and_info.tex


\setDocAbstract{
This is the test plan and report for \milestoneId{} (\milestoneName{}), an LSST level 2 milestone pertaining to the Data Management Subsystem.
}


\maketitle

\section{Introduction}
\label{sect:intro}


\subsection{Objectives}
\label{sect:objectives}

To acquire data from the spectrograph instrument along with proper
headers and transfer all data to NCSA for further viewing in LSP.~~



\subsection{System Overview}
\label{sect:systemoverview}

The spectragraph instrument is the first device to send real image data
to NCSA. ~ ~In the beginning, the image data from a new instrument
requires human viewing before setting the future of an image. ~It could
be deleted or be stored for further processing. ~ Therefore data will be
sent to NCSA for further viewing through the LSST Science Platform
(LSP). ~ ~If further processing or the data is to be kept for further
analysis or access, it will be ingested into the DBB along with
metadata, ~provenance along with being flagged for further processing. ~
Version 1.0 of this test will have data written from the spectragraph
directly to a local filesystem on the ATS system which is co-located
with the spectragraph instrument. ~ Data will be copied from that image
directory on the ATS system to NCSA and a ButlerG2 ingest process
completed so that the LSP can access the image file. ~ Version 2.0, when
the spectragraph is on the summit, of this test will be that all data
from the spectragraph will be written on the L1 handoff system which
will be at the BDC (base data center). ~The L1 handoff system will have
the OODS service and the DBB service installed. ~The DBB service will
transfer the data to NCSA and use the header files to generate
metadata/provenance data. ~The DBB will be responsible to generate the
ButlerG3 access files along with protect the data from never loosing it,
and ingest it into the permanent record of the survey. ~The L1 handoff
system through the OODS will enable quick access to images that were
just taken and keep 30 days worth of cache for scientists to view as
needed from the summit LSP. ~\\[2\baselineskip]

\subsection{Applicable Documents}\label{applicable-documents}

\citeds{LDM-294} Data Management Organization and Management\\
\citeds{LDM-503} DM Test Plan\\
\citeds{LDM-148} Data Management System Design


\subsection{Document Overview}
\label{sect:docoverview}

This document was generated from Jira, obtaining the relevant information from the 
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testPlan/LVV-P32}{LVV-P32}
~Jira Test Plan and related Test Cycles (
  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCycle/LVV-C56}{LVV-C56}
).

Section \ref{sect:intro} provides an overview of the test campaign, the system under test (\product{}), the applicable documentation, and explains how this document is organized.
Section \ref{sect:configuration}  describes the configuration used for this test.
Section \ref{sect:personnel} describes the necessary roles and lists the individuals assigned to them.
%Section \ref{sect:plannedtestactivities} provides the list of planned test cycles and test cases, including all relevant information that fully describes the test campaign.

Section \ref{sect:overview} provides a summary of the test results, including an overview in Table \ref{table:summary}, an overall assessment statement and suggestions for possible improvements.
Section \ref{sect:detailedtestresults} provides detailed results for each step in each test case.

The current status of test plan LVV-P32 in Jira is Draft.

\subsection{References}
\label{sect:references}
\renewcommand{\refname}{}
\bibliography{lsst,refs,books,refs_ads}
\section{Test Configuration}
\label{sect:configuration}

\subsection{Data Collection}

  Observing is not required for this test campaign.

\subsection{Verification Environment}
\label{sect:hwconf}
  The verification will be that a file is placed on the ATS system by the
spectragraph, and then it's transferred and viewed by scientists in the
LSP. ~


  \subsection{Entry Criteria}
  Image data taken by the spectragraph.~~


  \subsection{Exit Criteria}
  Image data from spectragraph viewable by LSP at NCSA.~



\section{Personnel}
\label{sect:personnel}

The following personnel are involved in this test activity:

\begin{itemize}
\item Test Plan (LVV-P32) owner: Michelle Butler
\item Test Cycles:
\begin{itemize}
  \item LVV-C56 owner: 
    Michelle Gower
  \begin{itemize}
    \item Test case LVV-T454 tester: 
  \end{itemize}
\end{itemize}
\item Additional Test Personnel involved: None
\end{itemize}

\newpage

\section{Overview of the Test Results}
\label{sect:overview}

\subsection{Summary}
\label{sect:summarytable}

\begin{longtable}{p{0.12\textwidth}p{0.2\textwidth}p{0.56\textwidth}p{0.12\textwidth}}
\toprule
  \multicolumn{3}{c}{ Test Cycle {\bf LVV-C56: LDM-503-8 Enable spectragraph data viewable by LSP.
 }} \\\hline
  {\bf \footnotesize test case} & {\bf \footnotesize status} & {\bf \footnotesize comment} & {\bf \footnotesize issues} \\\toprule
    \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T454}{LVV-T454} 
    & Not Executed &  &
    \\\hline

\caption{Test Results Summary}
\label{table:summary}
\end{longtable}

\subsection{Overall Assessment}
\label{sect:overallassessment}

Not yet available.

\subsection{Recommended Improvements}
\label{sect:recommendations}

Not yet available.

\newpage
\section{Detailed Test Results}
\label{sect:detailedtestresults}


  \subsection{Test Cycle LVV-C56 }

Open test cycle {\it \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testrun/LVV-C56}{LDM-503-8 Enable spectragraph data viewable by LSP.
}} in Jira.

  LDM-503-8 Enable spectragraph data viewable by LSP.
\\
  Status: Not Executed

  Image data needs to be created and available for transfer to NCSA. ~The
data will be transferred to NCSA and made available to scientists for
viewing and verification.~ ~~


  \subsubsection{Software Version/Baseline}
    Not provided.

  \subsubsection{Configuration}
    ATS system connected to spectragraph DAQ is required to have well formed
image data. ~Well formed means ``good'' image and correct headers.
~\\[2\baselineskip]


  \subsubsection{Test Cases in LVV-C56 Test Cycle}


    \paragraph{Test Case LVV-T454 }\mbox{}\\

Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T454}{\textit{ LVV-T454 } }
test case in Jira.

    \begin{itemize}
\tightlist
\item
  Acquire spectragraph image data, transfer that data to NCSA, ingest
  data into some Butler (G2 or G3 when available), and enable viewing of
  data on LSP. ~
\end{itemize}


    {\bf Preconditions}:\\
    Data must be well formed on Spectragraph data archiving system (ATS).
~Well-formed means that it has good headers and the file names are
unique. ~


    Execution status: {\bf Not Executed }

    Final comment:\\


    Detailed step results:

    \begin{longtable}{p{1cm}p{2cm}p{13cm}}
    \hline
    {Step} & \multicolumn{2}{c}{Description, Results and Status}\\ \hline
      1 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      Have data on the ATS archiver system from the spectragraph.~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & Expected Result & 

      \begin{minipage}[t]{13cm}{\footnotesize
      Well formed files on the ATS system that need to be transferred to NCSA
for further analysis

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      2 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      human runs script to transfer data to NCSA through secure pipeline, or a
cronjob starts up data ``sync'' process.~~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & Expected Result & 

      \begin{minipage}[t]{13cm}{\footnotesize
      Data is transferred to NCSA, and is located in NCSA file
systems.\\[2\baselineskip]

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      3 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      All files transferred have a ButlerG2 (or G3 when ready) ingest
process.~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & Expected Result & 

      \begin{minipage}[t]{13cm}{\footnotesize
      files now can be accessed by Butler access methods\\[2\baselineskip]

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

      4 & Description &

      \begin{minipage}[t]{13cm}{\footnotesize
      LSP processes can now view spectragraph generate files~

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & Expected Result & 

      \begin{minipage}[t]{13cm}{\footnotesize
      LSP jupyter notebooks can view spectragraph files.\\[2\baselineskip]

      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}

      & \begin{minipage}[t]{2cm}{Actual\\ Result}\end{minipage}   & 
      \begin{minipage}[t]{13cm}{\footnotesize
      
      \vspace{\dp0}
      } \end{minipage} \\
      \\ \cdashline{2-3}


      & Status          & Not Executed \\ \hline

    \end{longtable}


\input{appendix.tex}
\end{document}
